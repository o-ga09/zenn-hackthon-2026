# Stripe決済 導入対応ロードマップ

個人開発者がStripeを最短かつ安全に導入するためのガイドラインです。

## 1. アカウント準備と基本設定

まずは「ビジネス」としてStripeに認識されるための準備をします。

* **Stripeアカウントの作成**: 公式サイトから登録。
* **本人確認（KYC）**: 個人の場合はマイナンバーカードや免許証のアップロードが必要です。
* **銀行口座の登録**: 売上の振込先を指定します。
* **本番環境利用の申請**: サービス内容を記載して申請します。審査には数日かかる場合があるため、早めに行いましょう。

---

## 2. 実装方式の決定

自分のサービスの「作り込み具合」に合わせて、以下の3つから選択します。

| 方式 | 難易度 | 特徴 | 向いているケース |
| --- | --- | --- | --- |
| **Payment Links** | 低 | URLを貼るだけ。コード不要。 | SNSでの販売、シンプルな寄付。 |
| **Stripe Checkout** | 中 | Stripeが用意した決済画面へ遷移。 | **個人開発の推奨。** 実装が楽で安全。 |
| **Stripe Elements** | 高 | 自社サイト内に決済フォームを埋め込む。 | デザインを完全に制御したい場合。 |

---

## 3. 技術的な実装（開発フェーズ）

開発環境（テストモード）で以下の流れを実装します。

### ① APIキーの管理

* `公開可能キー (pk_test_...)` と `シークレットキー (sk_test_...)` を`.env`などで管理する。
* **注意:** シークレットキーは絶対にフロントエンドに露出させないこと。

### ② チェックアウトセッションの作成

* サーバー側で `stripe.checkout.sessions.create` を呼び出し、決済URLを発行する。

### ③ Webhookの実装（最重要！）

* ユーザーが決済画面でブラウザを閉じても、サーバー側で「購入完了」を検知するために必須です。
* `checkout.session.completed` イベントを受け取り、DBのステータスを更新する処理を書きます。

### ④ メタデータの活用

* `metadata` フィールドに `user_id` や `order_id` を含めておくと、Webhook受信時の照合が楽になります。

---

## 4. 法的対応（日本国内で必須）

個人開発でも、日本で決済を扱う以上は避けて通れません。

* **特定商取引法に基づく表記**:
* 販売価格、支払い時期、返品の可否、運営者情報（氏名・住所・電話番号）を記載したページが必要です。
* Stripeのダッシュボード内で生成・ホストすることも可能です。


* **プライバシーポリシーの更新**:
* 決済代行業者（Stripe）に個人情報を送る旨を追記します。



---

## 5. テストと本番移行

* **テストカードによる検証**: `4242...` などのテスト用番号で、正常系・異常系（期限切れなど）を確認。
* **本番キーへの切り替え**: `pk_live_...` と `sk_live_...` に差し替え。
* **Webhookの署名検証**: 本番環境ではWebhookエンドポイントのシークレットが異なるため、必ず設定を更新します。

---

## 6. 運用・保守

* **領収書メールの設定**: Stripeの管理画面から自動送信をONにできます。
* **返金フローの確認**: ダッシュボードから1クリックで返金できる手順を確認しておきましょう。
* **ダッシュボードアプリの導入**: スマホアプリを入れておくと、売上の通知が来てモチベーションが上がります。

## 7. 住所・電話番号のプライバシー対策（重要）

特商法では原則として「本人に確実に繋がる連絡先」が必要です。しかし、自宅住所を出すのが不安な場合は、以下の対策が一般的です。

* **住所**: **バーチャルオフィス**（GMOオフィスサポート、レゾナンスなど）を契約する。月額数百円〜で「ビジネス用の住所」を借りられます。
* **電話番号**: **050番号**（My050など）や、IP電話アプリを取得する。個人の携帯番号を直接載せるのは避けましょう。

---

## 8. Stripeでの設定手順

Stripeのダッシュボード上で、以下の手順でページを作成します。

1. **設定を開く**: ダッシュボード右上の「歯車アイコン」→「ビジネス設定」→**「公開情報」**を選択。
2. **情報を入力**:
* **事業者名称**: あなたの氏名（フルネーム）
* **事業所住所**: 1で準備した住所
* **電話番号**: 1で準備した番号
* **サポートウェブサイト**: サービスのURL


3. **規約ページの有効化**:
* 「設定」→「チェックアウトと支払い」または「顧客ポータル」セクションにある**「規約用ページ」**の設定へ。
* Stripeがホストする「特定商取引法に基づく表記」を「有効」にします。
* これにより、 `https://billing.stripe.com/p/regulations/...` といったURLで法的に必要な項目がまとまったページが自動生成されます。



---

## 9. 「特商法に基づく表記」に記載すべき内容（雛形）

Stripeの自由入力欄や、自前でページを作る場合に組み込むべき基本テンプレートです。

| 項目 | 記載例 |
| --- | --- |
| **販売価格** | 各購入ページに表示された価格に基づきます。 |
| **代金の支払時期** | クレジットカード決済時にお支払いが確定します。 |
| **代金の支払方法** | クレジットカード（Visa, Master, Amex等） |
| **商品引き渡し時期** | 決済完了後、即時（またはログイン後すぐに利用可能）。 |
| **返品・キャンセル** | デジタルコンテンツの特性上、決済完了後の返金・返品はできません。 |
| **動作環境** | Webブラウザ（Chrome, Safari最新版）が動作する端末。 |
| **販売責任者** | [あなたの氏名] |
| **所在地** | [1で用意した住所] |
| **連絡先** | [1で用意した電話番号] または [メールアドレス] |

---

## 10. サービスサイトへの設置

ページ（URL）ができたら、ユーザーがいつでも確認できるようにリンクを設置します。

* **フッターへのリンク**: サイトの一番下に「特定商取引法に基づく表記」というテキストリンクを置くのが一般的です。
* **Stripe Checkoutとの連携**: Stripeの決済画面（Checkout）を使っている場合、設定からこの特商法ページへのリンクを自動で表示させることができます。

---

## アドバイス：法人名義にする必要はある？

「個人名を出したくないから屋号（サービス名）だけで書きたい」という相談をよく受けますが、特商法は「消費者を守るための法律」なので、**個人の場合は原則として戸籍上の氏名**を書く必要があります。ここは「ビジネスの信頼性」として割り切って、バーチャルオフィス等で守りを固めるのが正攻法です。
